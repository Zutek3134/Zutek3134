<!DOCTYPE html>
<html lang="zh-tw">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公、市、臺制度量衡比較 — Zutek’s Secret Warehouse</title>
    <meta name="description" content="">

    <link rel="icon" type="image/x-icon" href="/images/zeeb.png">
    <link href='/stylesheets/style.css' rel='stylesheet'>
    <link href='/stylesheets/mandarinSupport.css' rel='stylesheet'>
    <link href='/js/tabs/stylesheet.css' rel='stylesheet'>
    <style>
        input,
        textarea,
        .txtOutput {
            font-family: var(--mono-font);
        }

        .txtOutput {
            overflow-x: auto;
        }

        .rule {
            display: flex;
            gap: var(--gap-half);
            margin-bottom: var(--gap-half);
        }

        sub {
            vertical-align: baseline;
            font-size: 70%;
            margin-left: 1em;
        }
    </style>
</head>

<body>
    <nav id="nav-placeholder"></nav>
    <main>
        <div class="container">
            <h1>公制、市制、臺制度量衡比較</h1>
            <p class="display-none"></p>
            <div data-tab-category="dulianghung">
                <div class="tab-nav">
                    <div class="tab-nav-inner">
                        <button class="tab-button" onclick="tabSelect('du', this)">度</button>
                        <button class="tab-button" onclick="tabSelect('liang', this)">量</button>
                        <button class="tab-button" onclick="tabSelect('hung', this)">衡</button>
                        <div class="tab-underline"></div>
                    </div>
                </div>
                <div data-tab-id="du" class="tab-content active">
                    <h2 class="display-none">度</h2>
                    <section class="mar-b-2">
                        <h3>公制</h3>
                        <div class="alert alert-info">
                            <div class="alert-icon"></div>
                            <p class="alert-message">每位都是<span class="hanLat">10</span>進制。</p>
                        </div>
                        <div class="table-container">
                            <table>
                                <tr>
                                    <th>華文定名<sub>臺標</sub></th>
                                    <th>國際定名</th>
                                    <th>華文合字</th>
                                    <th>國際縮寫</th>
                                </tr>
                                <tr>
                                    <td>公里</td>
                                    <td>kilometre</td>
                                    <td>粴</td>
                                    <td>km</td>
                                </tr>
                                <tr>
                                    <td>公引</td>
                                    <td>hectometre</td>
                                    <td>粌、粨</td>
                                    <td>hm</td>
                                </tr>
                                <tr>
                                    <td>公丈</td>
                                    <td>dekametre</td>
                                    <td>粀</td>
                                    <td>dam</td>
                                </tr>
                                <tr>
                                    <td>公尺</td>
                                    <td>metre</td>
                                    <td>米、粎</td>
                                    <td>m</td>
                                </tr>
                                <tr>
                                    <td>公寸</td>
                                    <td>decimetre</td>
                                    <td>籿</td>
                                    <td>dm</td>
                                </tr>
                                <tr>
                                    <td>公分</td>
                                    <td>centimetre</td>
                                    <td>粉</td>
                                    <td>cm</td>
                                </tr>
                                <tr>
                                    <td>公釐</td>
                                    <td>millimetre</td>
                                    <td>糎</td>
                                    <td>mm</td>
                                </tr>
                            </table>
                        </div>
                    </section>
                    <section class="mar-b-2">
                        <h3>市制</h3>
                        <div class="alert alert-info">
                            <div class="alert-icon"></div>
                            <p class="alert-message">除<span class="hanLat">1</span>里等於<span class="hanLat">15</span>引外，每位都是<span class="hanLat">10</span>進制。</p>
                        </div>
                        <div class="table-container">
                            <table class="text-right">
                                <tr>
                                    <th class="text-left">定名</th>
                                    <th>合公</th>
                                </tr>
                                <tr>
                                    <td class="text-left">里</td>
                                    <td><span class="hanLat">0.5</span>公里</td>
                                </tr>
                                <tr>
                                    <td class="text-left">引</td>
                                    <td><span class="hanLat">33.<span class="text-deco-over">3</span></span>公尺</td>
                                </tr>
                                <tr>
                                    <td class="text-left">丈</td>
                                    <td><span class="hanLat">3.<span class="text-deco-over">3</span></span>公尺</td>
                                </tr>
                                <tr>
                                    <td class="text-left">尺</td>
                                    <td><span class="hanLat">0.<span class="text-deco-over">3</span></span>公尺</td>
                                </tr>
                                <tr>
                                    <td class="text-left">寸</td>
                                    <td><span class="hanLat">3.<span class="text-deco-over">3</span></span>公分</td>
                                </tr>
                                <tr>
                                    <td class="text-left">分</td>
                                    <td><span class="hanLat">0.<span class="text-deco-over">3</span></span>公分</td>
                                </tr>
                                <tr>
                                    <td class="text-left">釐</td>
                                    <td><span class="hanLat">0.<span class="text-deco-over">3</span></span>公釐</td>
                                </tr>
                                <tr>
                                    <td class="text-left">毫</td>
                                    <td><span class="hanLat">0.0<span class="text-deco-over">3</span></span>公釐</td>
                                </tr>
                            </table>
                        </div>
                    </section>
                    <section class="mar-b-2">
                        <h3>臺制</h3>
                        <div class="alert alert-info">
                            <div class="alert-icon"></div>
                            <p class="alert-message">每位都是<span class="hanLat">10</span>進制。</p>
                        </div>
                        <div class="table-container">
                            <table class="text-right">
                                <tr>
                                    <th class="text-left">定名</th>
                                    <th>合公</th>
                                </tr>
                                <tr>
                                    <td class="text-left">臺丈</td>
                                    <td><span class="hanLat">3.<span class="text-deco-over">03</span></span>公尺</td>
                                </tr>
                                <tr>
                                    <td class="text-left">臺尺</td>
                                    <td><span class="hanLat">30.<span class="text-deco-over">30</span></span>公分</td>
                                </tr>
                                <tr>
                                    <td class="text-left">臺寸</td>
                                    <td><span class="hanLat">3.<span class="text-deco-over">03</span></span>公分</td>
                                </tr>
                                <tr>
                                    <td class="text-left">臺分</td>
                                    <td><span class="hanLat">0.<span class="text-deco-over">30</span></span>公分</td>
                                </tr>
                            </table>
                        </div>
                    </section>
                    <hr>
                    <section id="lengthConverter" class="mar-b-2">
                        <div id="rulesContainer" class="mar-b-05"></div>
                        <div class="row">
                            <div class="item-width"><button class="btn btn-fill btn-success pad-0" onclick="addRule(this)"><span class="twemoji mar-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                                            <path d="M7.75 2a.75.75 0 0 1 .75.75V7h4.25a.75.75 0 0 1 0 1.5H8.5v4.25a.75.75 0 0 1-1.5 0V8.5H2.75a.75.75 0 0 1 0-1.5H7V2.75A.75.75 0 0 1 7.75 2" />
                                        </svg></span></button></div>
                            <div class="width-full" style="flex: 1;"></div>
                            <div class="item-width">
                                <button class="btn btn-danger pad-0" onclick="clearFields()"><span class="twemoji mar-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                            <path d="M9 3v1H4v2h1v13a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6h1V4h-5V3zm0 5h2v9H9zm4 0h2v9h-2z" />
                                        </svg></span></button>

                            </div>
                        </div>
                    </section>
                </div>
                <div data-tab-id="liang" class="tab-content">
                </div>
                <div data-tab-id="hung" class="tab-content">
                </div>
            </div>
    </main>
    <footer id="footer-placeholder"></footer>
    <script src="/includes/includes.js"></script>
    <script src="/js/tabs/script.js"></script>
    <script>
        let inputId = 0;
        const rulesDiv = document.getElementById("rulesContainer");

        function createSelectElement(category) {
            const select = document.createElement("select");
            select.className = "width-full";

            const groups = {
                length: [
                    {
                        label: "公制",
                        options: [
                            { value: 1000, text: "公里" },
                            { value: 100, text: "公引" },
                            { value: 10, text: "公丈" },
                            { value: 1, text: "公尺", selected: true },
                            { value: 0.1, text: "公寸" },
                            { value: 0.01, text: "公分" },
                            { value: 0.001, text: "公釐" }
                        ]
                    },
                    {
                        label: "市制",
                        options: [
                            { value: 500, text: "市里" },
                            { value: 33.333333, text: "市引" },
                            { value: 3.333333, text: "市丈" },
                            { value: 0.333333, text: "市尺" },
                            { value: 0.033333, text: "市寸" },
                            { value: 0.003333, text: "市分" },
                            { value: 0.000333, text: "市釐" },
                            { value: 0.000033, text: "市毫" }
                        ]
                    },
                    {
                        label: "臺制",
                        options: [
                            { value: 3.030303, text: "臺丈" },
                            { value: 0.30303, text: "臺尺" },
                            { value: 0.030303, text: "臺寸" },
                            { value: 0.00303, text: "臺分" }
                        ]
                    }
                ]
            };

            groups[category.replace('Converter', '')].forEach(group => {
                const optgroup = document.createElement("optgroup");
                optgroup.label = group.label;
                group.options.forEach(opt => {
                    const option = document.createElement("option");

                    option.value = opt.value;
                    option.textContent = opt.text;

                    if (opt.selected)
                        option.selected = true;

                    optgroup.append(option);
                });
                select.append(optgroup);
            });

            return select;
        }

        function addRule(element) {
            inputId++;

            const div = document.createElement("div");
            div.className = "rule";

            const input = document.createElement("input");
            input.type = "number";
            input.id = `${inputId}`;
            input.className = "width-full";
            input.placeholder = "0";
            input.step = "any";
            input.value = 1;
            input.oninput = () => convertAll(input);

            const category = element.closest('section').id;
            const select = createSelectElement(category);
            select.onchange = () => convertAll(input);

            const removeBtn = document.createElement("button");
            removeBtn.innerHTML = `<span class="twemoji mar-0" style="font-size: 1em"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M3.72 3.72a.75.75 0 0 1 1.06 0L8 6.94l3.22-3.22a.749.749 0 0 1 1.275.326.75.75 0 0 1-.215.734L9.06 8l3.22 3.22a.749.749 0 0 1-.326 1.275.75.75 0 0 1-.734-.215L8 9.06l-3.22 3.22a.75.75 0 0 1-1.042-.018.75.75 0 0 1-.018-1.042L6.94 8 3.72 4.78a.75.75 0 0 1 0-1.06"/></svg></span>`;
            removeBtn.className = "btn btn-fill btn-danger pad-0";
            removeBtn.onclick = () => div.remove();

            div.append(input, select, removeBtn);
            rulesDiv.appendChild(div);
        }

        function convertAll(triggeredInput) {
            const baseValue = parseFloat(triggeredInput.value) || 0;
            const baseUnitSelect = triggeredInput.nextElementSibling;

            if (!baseUnitSelect)
                return;

            const baseUnit = parseFloat(baseUnitSelect.value);

            document.querySelectorAll(".rule").forEach(rule => {
                const input = rule.querySelector("input");
                const unitSelect = rule.querySelector("select");

                if (!input || !unitSelect)
                    return;

                const targetUnit = parseFloat(unitSelect.value);
                if (input === triggeredInput)
                    return;

                input.value = Math.round((baseValue * baseUnit / targetUnit) * 10000) / 10000;
            });
        }


        function clearFields() {
            rulesDiv.innerHTML = "";
            addRule();
        }

        addRule();
    </script>
</body>

</html>